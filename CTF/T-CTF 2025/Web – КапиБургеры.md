#easy #web

#### Задача

| Вводные   | Материалы                                                                                                                                                                                                                                                     |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Исходники | Без исходников                                                                                                                                                                                                                                                |
| Сайт      | [**t-burger-j3ztwf0i.spbctf.org**](https://t-burger-j3ztwf0i.spbctf.org)                                                                                                                                                                                      |
| Условие   | Капибургерная — одно из любимых мест жителей города. И сейчас в ней появилось лимитированное блюдо — флаг! Но вот беда, цена в монетках за него просто космическая. Придумайте, как вам всё-таки получить его, а не остаться с одной пустой коробкой.<br><br> |

#### Решение
- После авторизации приклеивается JWT. Токен с зашифрованной сигнатурой - сломать без соли не получится. Соль неоткуда выудить. Смотрим дальше
- Пробуем покупать – выдираем из консоли сабмит и повторяем его fetch-ем в консоле, пробуем подменить ID товара. Не прокатывает - на сервере проверяется баланс.
- В одном из товаров можно кроме основного товара, добавить бесплатную опцию. Пробуем купить, копируем запрос - там и в товаре и в бесплатной опции передаются ID товаров. 
- Пихаем ID нужного товара в поле бесплатной опции и вауаля - победа: покупка товара проходит и отдает флаг. На серваке нет проверки при покупки бесплатных опций, можно прокинуть туда любой товар и он станет бесплатным


#### Скрины

![](./assets/image-11.webp)

![](./assets/image-12.webp)

![](./assets/image-13.webp)

![](./assets/image-14.webp)

![](./assets/image-15.webp)

![](./assets/image-16.webp)

![](./assets/image-17.webp)